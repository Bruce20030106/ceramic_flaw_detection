###ceramic-tile color difference (CTCD) 瓷砖颜色差异

#1、引言：
基于深度学习的方法需要大量具有相似分布的训练数据，而CTCD的捕获数据在这个项目中存在一些限制。**首先，单个陶瓷瓷砖生产线上有大量未标记的样本，而标记的陶瓷瓷砖样本较少。其次，来自同一陶瓷瓷砖生产线的CTCD差异微小，而来自不同陶瓷瓷砖生产线的样本差异巨大，例如不同的纹理和图案。**如图1所示，利用来自不同陶瓷瓷砖生产线的样本训练深度学习模型是困难的。图（a）和图（b）是**同一种类型但颜色不同**的陶瓷瓷砖图像，来自同一陶瓷瓷砖生产线；图（c）和图（d）是来自另一个陶瓷瓷砖生产线的同一类型但颜色不同的陶瓷瓷砖图像。
	
	图1
![](https://github.com/dhf97/image/raw/main/CCDM.png)

因此，作者专注于**单个陶瓷砖生产线的CTCD**，同时假设我们可以在**每个陶瓷砖生产线中获得少量标记样本**。通过这种方式，可以使用单个生产线中的少量标记数据实现对CTCD的自动颜色分离。根据上述介绍，我们提出了一个针对少量标记样本的CTCD颜色分离框架，如图2所示。由于提出的方法可以从陶瓷砖图像中提取颜色特征，因此可以使用少量标记样本的**SVM**实现CTCD的颜色分离。
	
	图2
![](https://github.com/dhf97/image/raw/main/OCSF.png)


##SVM(suport vector machine):
1. [支持向量机SVM是什么，八分钟直觉理解其本质](https://www.bilibili.com/video/BV16T4y1y7qj/?spm_id_from=333.337.search-card.all.click&vd_source=76039304b78bf351fa45d5750955e749)

2. [SVM教程：支持向量机的直观理解](https://zhuanlan.zhihu.com/p/40857202)

支持向量机（Support Vector Machine，简称SVM）是一种二分类模型，它的目标是找到一个超平面（在低维空间中即为一条直线），将不同类别的数据点分开。具体来说，**SVM通过在数据空间中找到距离不同类别样本最近的若干个数据点（称为支持向量），然后求解一个最大间隔超平面，将数据空间分为两个区域，从而实现对数据的分类。**

对于**线性可分**的情况，SVM通过最大化间隔的方式找到最优解，使得分类器对噪声数据具有较强的鲁棒性。对于非线性可分的情况，SVM通过将数据映射到高维特征空间中，使得数据在该空间中线性可分，从而得到一个非线性的分类器。通常，SVM采用核函数（如线性核函数、多项式核函数、高斯核函数等）来完成特征空间的转换。

###线性可分：
可以被一条直线（更一般的，一个超平面）分割的数据称为线性可分（linearly separable）数据。超平面起到线性分类器（linear classifier）的作用。

SVM的优点在于具有较强的泛化能力、较强的鲁棒性和高效的计算性能，被广泛应用于模式识别、图像处理、文本分类等领域。此外，SVM还可以处理高维数据，对于训练数据量较小的情况也表现较好。不过，SVM的缺点在于其对于参数的选取比较敏感，需要较为严格的参数调优，同时在处理大规模数据集时可能会遇到计算困难等问题。

	如图
![](https://github.com/dhf97/image/raw/main/SC.png)
![](https://github.com/dhf97/image/raw/main/BG.png)
![](https://github.com/dhf97/image/raw/main/SVM.png)


#2、相关工作：
	机翻：随着机器视觉和机器学习技术的发展，许多人提出了解决色差问题的新方法。杨凌等[1] 提出了一种基于 CIE 1976 - L*a*b* 瓷砖空间的色差测量方法。但限制条件是瓷砖具有相当单调的表面颜色，只有几种字符颜色，色差公式只能测量两种单独的颜色。Saeed Hosseinzadeh Hanzaei 等人[2] 提出了一种可以自动检测和分类瓷砖表面缺陷的方法。他们把tile当成一个分类任务，用支持向量机来完成这个分类任务。和蔡红苏等人。[3]提出了一种基于改进局部色调累积直方图的瓷砖颜色缺陷自动检测新算法。唐旭日等[4] 提出了一种基于直方图统计值的色差方法。他们选择H通道直方图统计值作为特征向量来训练分类器。在本文中，我们提出了一种基于 HSV 颜色空间的 CTCD 在少量标记样本下的颜色分离框架，可用于实际生产。

#3、框架
首先，我们对瓷砖图像进行**预处理**，以获得仅包含瓷砖的图像。其次，我们**将瓷砖从RGB模型转换为HSV模型**。然后，我们**将图像分成许多子区域，并通过直方图统计提取瓷砖的特征**。最后，**使用由少量图像组成的训练集中提取的特征来训练支持向量机分类器**，并使用训练好的分类器按颜色差异对瓷砖进行分类。

##HSV颜色模型
HSV（Hue色相、Saturation饱和度、Value明度）颜色模型更适用于图像处理并符合人眼观察颜色的习惯。转换公式如下：
![](https://github.com/dhf97/image/raw/main/HSV.png)

HSV (Hue-Saturation-Value) 颜色空间比 RGB 颜色空间更适合用于机器学习的原因有几点：

1. 直观性：HSV 颜色空间与人类视觉的感知方式更加接近。在 HSV 颜色空间中，色调 (Hue) 对应的是颜色的种类，饱和度 (Saturation) 对应的是颜色的纯度，明度 (Value) 对应的是颜色的亮度。因此，HSV 颜色空间更加直观，更符合人类对颜色的感知。

2. 具有单一信息的通道：在 RGB 颜色空间中，R、G、B 通道之间的相关性很强，难以分离出单一的颜色信息。而在 HSV 颜色空间中，色调、饱和度、明度三个通道之间的相关性较弱，每个通道包含的信息都比较独立。这使得在 HSV 颜色空间中进行特征提取和分类更加容易和准确。

3. 对光照和亮度变化的鲁棒性：在 RGB 颜色空间中，光照和亮度的变化会对颜色信息造成很大的影响，从而影响机器学习算法的准确性。而在 HSV 颜色空间中，色调和饱和度通道对光照和亮度变化不敏感，只有明度通道会受到影响。这使得在 HSV 颜色空间中进行特征提取和分类更加鲁棒。

##瓷砖构建颜色特征
数据集中的瓷砖图像具有许多复杂的纹理，因此我们将瓷砖图像**分成 m x m 个子区域**，以便我们可以提取更多的纹理细节特征。对于每个子区域，我们对色相、饱和度和明度通道进行直方图统计。对于**色相**通道，我们可以提取特征向量** f1**，并将其**归一化**为大小为1 x 255；对于**饱和度和明**度通道，我们可以直接提取大小为1 x 255的特征向量 **f2 和 f3**。一个子区域的特征 F1 可以由 f1、f2 和 f3 组成。最后，与每个子区域对应的特征被集成以提取图像特征 F，F1，F2...Fm。特征向量 F 的大小为 m x 3 x 255。特征向量 F 的大小取决于所划分的子区域数量，并且可以使用主成分分析等方法根据实际需要进行压缩，以帮助减小训练模型的大小。

###归一化：
对于色相通道，经过直方图统计后得到一个特征向量f1，其值可能在0到360之间，但是为了方便处理，可以将这个范围归一化到0到255之间。具体方法是**将0到360的范围分成255个等距离的区间**，每个区间对应的值为该区间的中心值，然后将每个像素的色相值映射到对应的区间中心值上，最终得到一个大小为1 x 255的特征向量。

##训练模型
简单概括就是训练SVM

![](https://github.com/dhf97/image/raw/main/TMFC.png)

#4、实验结果

##单通道和多通道特征提取
在400张两种颜色编号的陶瓷瓷砖图像中，我们随机选择了其中的112张作为分类器训练的训练集，剩下的288张则作为测试集。为了模拟实际生产中只能使用少量图像进行训练的情况，我们设置不同的训练集比例来训练分类器，并观察分类器的分类性能。我们**分别对色调、饱和度和亮度通道进行直方图统计，并进行单通道特征提取和三通道特征提取**，以验证我们的特征提取方法的可行性。

表1：仅通过一个通道和两个三个通道提取特征的结果。并选择多项式的核函数作为支持向量机分类器的核函数，将惩罚参数C设置为1，表达式多项式的维数设置为3。

![](https://github.com/dhf97/image/raw/main/TB1.png)

在我们的预设实验环境中，单通道特征提取每个图像所需的平均时间为0.385秒，而三通道特征提取的平均时间为0.41秒。 实验结果表明，我们提出的复杂图案瓷砖颜色特征提取方法是有效的。分类器在少量数据的训练下可以完成颜色相近的瓷砖的分类，在三通道颜色特征训练下可以更快。

##分区域和不分区域
设计了一个对比实验来验证我们提出的子区域特征提取方法与没有子区域划分的方法相比，在复杂图案的瓷砖颜色特征提取方面具有更好的结果。**实验结果表明，当可用于训练分类器的训练图像超过50张时，与不分块的特征提取相比，我们的特征提取方法具有更好的特征提取性能。**